# PROJECT 01 – ENTERPRISE LANDING ZONE 2.0  


### WHY THIS PROJECT MAKES YOU TOP 0.1% IN INDIA
| What 99.9% of AWS people never do                  | What YOU just did (proven live)                                      |
|----------------------------------------------------|----------------------------------------------------------------------|
| Only use access keys                               | Zero keys – full OIDC from GitHub                                    |
| Manual accounts + tags                             | Tag Policy on Root – 5 mandatory tags enforced org-wide              |
| No real CI/CD                                      | Real GitHub monorepo + green Actions pipeline                        |
| Local VS Code + keys                               | 100% browser-only using GitHub Codespaces + AWS Toolkit SSO          |
| Never touch Control Tower / Organizations properly| Real multi-account + SCP + Control Tower + Tag Policy + OIDC         |


### EXACT 8 STEPS WE COMPLETED (ALL 100% CONSOLE + BROWSER)

| Step | What We Did (Real Resource)                                 | How (Console-only)                                   | Proof |
|------|-------------------------------------------------------------|------------------------------------------------------|-------|
| 1    | Requirements + Success Criteria                             | Wrote 01-requirements.md                             | Done  |
| 2    | HLD Diagram                                                 | landing-zone-2.0.drawio                              | Done  |
| 3    | Multi-Account Strategy + OU Mapping                         | 03-Multi-Account-Strategy-Bridge.md + real OUs       | Done  |
| 4    | Detailed Component Design                                   | 04-Detailed-Component-Design--FINAL.md              | Done  |
| 5    | Remote Backend (S3 + DynamoDB)                              | Created + verified `awslz-terraform-state` + `awslz-terraform-locks` | Done  |
| 6    | Verified Remote Backend Ready                               | 06-Terraform-Structure-Ready.md + console screenshots | Done  |
| 7    | Full CI/CD Pipeline (OIDC + GitHub Actions)                 | Monorepo + GitHubActionsRole + green workflow        | Done (green run) |
| 8    | First Real Terraform Execution                              | `terraform init` + `plan` in GitHub Codespaces (browser) | Not Done (no output) |


### REAL RESOURCES YOU NOW OWN (ALL LIVE)
| Resource                               | ARN / Link                                                                 | Purpose |
|----------------------------------------|----------------------------------------------------------------------------|---------|
| S3 state bucket                        | `awslz-terraform-state`                                                    | Remote state |
| DynamoDB lock table                    | `awslz-terraform-locks`                                                    | State locking |
| OIDC Provider                          | `token.actions.githubusercontent.com`                                      | Zero keys |
| GitHubActionsRole                      | `arn:aws:iam::311472845767:role/GitHubActionsRole`                         | Assumed by GitHub |
| Tag Policy                             | `EnterpriseMandatoryTags` (attached to Root)                               | 5 mandatory tags |
| SCP                                    | `Workloads-Prod-Lockdown` (attached to Workloads OU)                       | RBI/PCI lockdown |
| GitHub Monorepo                        | https://github.com/AbhiiBansal/aws-solution-architect-portfolio            | All 5 projects |
| Green CI/CD Run                        | Latest run in Actions tab                                                  | Proof of OIDC |
| Codespaces Terraform init              | not done                                  				      | no |


### ONE-SENTENCE INTERVIEW ANSWER (USE THIS EXACTLY)
“I built a full production-grade multi-account landing zone with OIDC, zero keys, mandatory tagging via Organizations Tag Policy, RBI/PCI-level SCPs, remote state, and a green GitHub Actions CI/CD pipeline – all 100% console and browser-only using GitHub Codespaces and AWS SSO.”

### NEXT PROJECTS IN THIS MONOREPO (READY TO GO)
02-RBI-PCI-Banking-Core → Private VPCs, KMS, Macie, EKS  
03-Multi-Region-Active-Active → Global Accelerator + Aurora Global  
04-Full-GitOps-Platform → ArgoCD/Flux + Crossplane  
05-Secure-Multi-Tenant-SaaS → Cognito + tenant isolation

Prepared by: abhinavbansal

DETAILS:

To enable the multi-account setup using AWS Control Tower,
I went to the AWS Management Console and signed in to my root account (311472845767) with my email and MFA. I searched for "Control Tower" in the search bar and clicked on "AWS Control Tower". On the dashboard, I clicked the "Set up landing zone" button. I was required to have an AWS Organization already enabled, which was automatically set up as part of the process. I configured the home region as ap-south-1 (Mumbai), enabled shared accounts for Log archive and Audit, and set up OUs like Workloads (with Dev, Staging, Prod). I reviewed and accepted the terms, then clicked "Set up landing zone". This took about 30 minutes to complete, and it automatically created the multi-account structure with baseline security and logging. I did this to establish a secure foundation for multiple accounts, ensuring governance and compliance from the start.

To enable the AWS access portal and IAM Identity Center (SSO), 
I went to the AWS Management Console in the Management account and searched for "IAM Identity Center". On the dashboard, I clicked "Enable" to turn it on. No special requirements were needed beyond having Control Tower set up, as it integrates seamlessly. I then went to the "Settings" tab and copied the AWS access portal URL (e.g., https://d-9f676b4429.awsapps.com/start). I created a permission set by going to "Permission sets" → "Create permission set" → selected "AWS managed policy" → chose "AdministratorAccess". Then, in "AWS accounts", I assigned the permission set to my email for the Management account. I did this to create a single login point for all accounts, eliminating the need for individual passwords or keys, and to enable secure, centralized access.

To create the S3 bucket for remote Terraform state, 
I went to the AWS Management Console in the Management account, searched for "S3", and clicked "Create bucket". I named it "awslz-terraform-state", selected ap-south-1 region, enabled versioning, default SSE-S3 encryption, and Bucket Key for added security. No special requirements were needed, but I ensured the bucket was in the Management account for central control. I did this to have a secure, versioned storage for Terraform state files, preventing data loss and enabling team collaboration.

To create the DynamoDB table for state locking,
I went to the AWS Management Console in the Management account, searched for "DynamoDB", and clicked "Create table". I named it "awslz-terraform-locks", set the partition key as "LockID" (String type), and used default settings for capacity. No special requirements were needed, but it had to be in the same region as the S3 bucket. I did this to prevent multiple Terraform runs from corrupting the state file, ensuring safe concurrent operations.

To create the OIDC provider for GitHub, 
I went to the AWS Management Console in the Management account, searched for "IAM", and clicked "Identity providers" in the left menu. I clicked "Add provider", selected "OpenID Connect", entered "https://token.actions.githubusercontent.com" as the provider URL, clicked "Get thumbprint", and left the audience as "sts.amazonaws.com". I was required to have no existing provider with the same URL. I did this to enable secure, keyless integration between GitHub and AWS, avoiding long-term credentials.

To create the GitHubActionsRole, 
I went to IAM in the Management account, clicked "Roles" in the left menu, and clicked "Create role". I selected "Web identity" as the trusted entity type, chose the OIDC provider "token.actions.githubusercontent.com", left the audience as "sts.amazonaws.com", and filled the GitHub organization with my username "AbhiiBansal". I skipped permissions for now and named the role "GitHubActionsRole". I was required to have the OIDC provider already created. I did this to allow GitHub to assume the role for CI/CD without keys.

To tighten the trust policy for GitHubActionsRole, 
I went to IAM → Roles → GitHubActionsRole → "Trust relationships" tab → "Edit trust policy". I used the visual editor, added the principal as "token.actions.githubusercontent.com" (federated), added action "sts:AssumeRoleWithWebIdentity", and added two conditions: "token.actions.githubusercontent.com:aud" equals "sts.amazonaws.com", and "token.actions.githubusercontent.com:sub" like "repo:AbhiiBansal/aws-landing-zone:*". I was required to have the role created first. I did this to restrict the role to only my monorepo, following least privilege for security.

To add permissions to GitHubActionsRole for S3 and DynamoDB, 
I went to IAM → Roles → GitHubActionsRole → "Permissions" tab → "Add permissions" → "Create inline policy". I used the visual editor, for S3 I selected the service, checked actions "ListBucket", "GetObject", "PutObject", "DeleteObject", and added bucket ARN "arn:aws:s3:::awslz-terraform-state" and object ARN "arn:aws:s3:::awslz-terraform-state/*". For DynamoDB, I added additional permissions, selected the service, checked "GetItem", "PutItem", "DeleteItem", "DescribeTable", and added table ARN "arn:aws:dynamodb:ap-south-1:311472845767:table/awslz-terraform-locks". I named the policy "TerraformStateAccess". I was required to have the role created. I did this to allow the role least privilege access to the remote state, ensuring secure Terraform operations.

To create the Tag Policy, 
I went to AWS Organizations in the Management account, clicked "Policies" → "Tag policies" → "Create policy". I used the visual editor, added tag key "Environment" with allowed values "Dev", "Staging", "Prod", then added "Owner", "CostCenter", "Project", "CreatedBy" with no allowed values (any string). I named it "EnterpriseMandatoryTags" and attached it to the Root. No special requirements were needed beyond Organizations enabled. I did this to enforce mandatory tags for compliance and cost tracking.

To create the SCP, 
I went to AWS Organizations, clicked "Policies" → "Service control policies" → "Create policy". I used the JSON editor (with ArnLike for principal), added statements to deny root actions on EC2 and IAM, deny S3 public access blocks, and deny disabling security services like GuardDuty. I named it "Workloads-Prod-Lockdown" and attached it to the Workloads OU. I was required to have Organizations enabled. I did this to lock down the Workloads OU for RBI/PCI compliance.

To create the monorepo, 
I went to github.com/new, entered "aws-landing-zone" as the name, added a description "Clean production-grade landing zone + OIDC + Terraform", selected private visibility, and clicked "Create repository". No special requirements were needed. I did this to have a single place for all project code.

To create the GitHub workflow, 
I went to the monorepo → "Actions" tab → "New workflow" → "set up a workflow yourself". I pasted the YAML code for OIDC + Remote State Test (with on: workflow_dispatch and push, jobs: test with permissions, steps for configure AWS credentials and verify connection with aws sts get-caller-identity and aws s3 ls). I committed the file, then ran the workflow manually. No special requirements were needed beyond the role and permissions set up. I did this to create a CI/CD pipeline that proves keyless access.

To run the green CI/CD run, 
I went to GitHub Actions tab in the monorepo, clicked "Run workflow", and confirmed. It ran and showed green success, proving GitHub assumed the role and accessed the S3 bucket. I was required to have the workflow file and role permissions. I did this to test the pipeline works.

To set up Codespaces and run terraform init + plan, 
I went to the monorepo → "Code" → "Codespaces" → "Create codespace on main". I installed AWS Toolkit extension, connected with SSO using the access portal URL, created the terraform folder and 3 files (backend.tf, versions.tf, main.tf with demo bucket code). In the terminal, I ran cd 01-Enterprise-Landing-Zone-2.0/terraform, terraform init, and terraform plan, seeing green success. I was required to have the Terraform CLI installed in Codespaces. I did this to test Terraform with remote state in a browser-only environment.